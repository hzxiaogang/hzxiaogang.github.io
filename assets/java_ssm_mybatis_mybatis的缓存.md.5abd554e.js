import{_ as s,o as a,c as n,V as l}from"./chunks/framework.364d6ed5.js";const d=JSON.parse('{"title":"mybatis的缓存","description":"","frontmatter":{"title":"mybatis的缓存","date":"2022-10-06T17:42:35.000Z","permalink":"/pages/313dd3/","categories":["java","ssm","mybatis"],"tags":[null]},"headers":[],"relativePath":"java/ssm/mybatis/mybatis的缓存.md","filePath":"java/ssm/mybatis/mybatis的缓存.md","lastUpdated":1685806707000}'),p={name:"java/ssm/mybatis/mybatis的缓存.md"},o=l(`<h1 id="mybatis的缓存" tabindex="-1">mybatis的缓存 <a class="header-anchor" href="#mybatis的缓存" aria-label="Permalink to &quot;mybatis的缓存&quot;">​</a></h1><h2 id="_1-mybatis-一级缓存" tabindex="-1">1. Mybatis 一级缓存 <a class="header-anchor" href="#_1-mybatis-一级缓存" aria-label="Permalink to &quot;1. Mybatis 一级缓存&quot;">​</a></h2><h3 id="_1-概念" tabindex="-1">1. 概念 <a class="header-anchor" href="#_1-概念" aria-label="Permalink to &quot;1. 概念&quot;">​</a></h3><p><code>MyBatis</code>一级缓存是 <code>SqlSession</code> 级别的，即通过<strong>同一个</strong> <code>SqlSession</code> 查询的数据会被缓存，下次查询相同的数据，就 会从缓存中直接获取，不会从数据库重新访问。</p><p><code>MyBatis</code>的一级缓存是<strong>默认开启的</strong></p><h3 id="_2-测试" tabindex="-1">2. 测试 <a class="header-anchor" href="#_2-测试" aria-label="Permalink to &quot;2. 测试&quot;">​</a></h3><h4 id="_1-cachemapper-接口" tabindex="-1">1. CacheMapper 接口 <a class="header-anchor" href="#_1-cachemapper-接口" aria-label="Permalink to &quot;1. CacheMapper 接口&quot;">​</a></h4><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">CacheMapper</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 根据员工 id 查询员工信息</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Emp</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getEmpById</span><span style="color:#89DDFF;">(@</span><span style="color:#C792EA;">Param</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">empId</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Integer</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">empId</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_2-cachemapper-映射文件" tabindex="-1">2. CacheMapper 映射文件 <a class="header-anchor" href="#_2-cachemapper-映射文件" aria-label="Permalink to &quot;2. CacheMapper 映射文件&quot;">​</a></h4><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> ?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;!</span><span style="color:#F78C6C;">DOCTYPE</span><span style="color:#89DDFF;"> </span><span style="color:#A6ACCD;">mapper</span></span>
<span class="line"><span style="color:#89DDFF;">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">mapper</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">namespace</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.zhug.mybatis.mapper.CacheMapper</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">resultMap</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cacheMapperResult</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Emp</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">id</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">column</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">emp_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">property</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">empId</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">result</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">column</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">emp_name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">property</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">empName</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">result</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">result</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">column</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">age</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">property</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">age</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">result</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">result</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">column</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">gender</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">property</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">gender</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">result</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">result</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">column</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dept_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">property</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">deptId</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">result</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">resultMap</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">select</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">getEmpById</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">resultMap</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cacheMapperResult</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        select  * from t_emp where  emp_id = #{empId}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">select</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">mapper</span><span style="color:#89DDFF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="_3-测试" tabindex="-1">3. 测试 <a class="header-anchor" href="#_3-测试" aria-label="Permalink to &quot;3. 测试&quot;">​</a></h4><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">com</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">zhug</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mybatis</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mapper</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">CacheMapper</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">com</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">zhug</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mybatis</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">pojo</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Emp</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">com</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">zhug</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">mybatis</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">utils</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">SqlSessionUtils</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">ibatis</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">session</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">SqlSession</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">junit</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Test</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">CacheMapperTest</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testGetEmpById</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSession</span><span style="color:#A6ACCD;"> sqlSession </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> SqlSessionUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getSqlSession</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">CacheMapper</span><span style="color:#A6ACCD;"> mapper </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sqlSession</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMapper</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CacheMapper</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Emp</span><span style="color:#A6ACCD;"> emp1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> mapper</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getEmpById</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">emp1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Emp</span><span style="color:#A6ACCD;"> emp2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> mapper</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getEmpById</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">emp2</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>案例中，我们调用了两次<code>getEmpById(1)</code>方法，可是控制台<code>log4j</code>就<strong>打印了一次 sql 执行语句</strong>，因为查询<code>emp2</code>的时候从缓存中直接获取，没有从数据库重新访问。</p><h3 id="_3-使一级缓存失效的四种情况" tabindex="-1">3.使一级缓存失效的四种情况 <a class="header-anchor" href="#_3-使一级缓存失效的四种情况" aria-label="Permalink to &quot;3.使一级缓存失效的四种情况&quot;">​</a></h3><ul><li><ol><li>不同的 SqlSession 对应不同的一级缓存</li></ol></li><li><ol start="2"><li>同一个 SqlSession 但是查询条件不同</li></ol></li><li><ol start="3"><li>同一个 SqlSession 两次查询期间执行了任何一次增删改操作</li></ol></li><li><ol start="4"><li>同一个 SqlSession 两次查询期间手动清空了缓存</li></ol></li></ul><p>下面我们演示手动清空一级缓存</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">CacheMapperTest</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testGetEmpById</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">SqlSession</span><span style="color:#A6ACCD;"> sqlSession </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> SqlSessionUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getSqlSession</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">CacheMapper</span><span style="color:#A6ACCD;"> mapper </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sqlSession</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMapper</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CacheMapper</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Emp</span><span style="color:#A6ACCD;"> emp1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> mapper</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getEmpById</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">emp1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 手动清空一级缓存</span></span>
<span class="line"><span style="color:#A6ACCD;">    sqlSession</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">clearCache</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Emp</span><span style="color:#A6ACCD;"> emp2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> mapper</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getEmpById</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">emp2</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>同一个 <code>SqlSession</code> 两次查询期间，我们通过<code>sqlSession.clearCache();</code>方法手动<strong>清空</strong>了一级缓存。我们可以看到控制的<code>log4j</code>打印了<strong>两次 sql 执行语句</strong></p><h2 id="_2-mybatis-二级缓存" tabindex="-1">2. Mybatis 二级缓存 <a class="header-anchor" href="#_2-mybatis-二级缓存" aria-label="Permalink to &quot;2. Mybatis 二级缓存&quot;">​</a></h2><h3 id="_1-概念-1" tabindex="-1">1. 概念 <a class="header-anchor" href="#_1-概念-1" aria-label="Permalink to &quot;1. 概念&quot;">​</a></h3><p><code>MyBatis</code>二级缓存是 <code>SqlSessionFactory</code> 级别。即通过<strong>同一个</strong> <code>SqlSessionFactory</code> 创建的 <code>SqlSession</code> 查询的结果会被 缓存；此后若再次执行相同的查询语句，结果就会从缓存中获取（<code>SqlSession</code>可以不是同一个，但必须都是同一个<code>SqlSessionFactory</code>创建的）</p><h3 id="_2-二级缓存开启条件" tabindex="-1">2. 二级缓存开启条件 <a class="header-anchor" href="#_2-二级缓存开启条件" aria-label="Permalink to &quot;2. 二级缓存开启条件&quot;">​</a></h3><ul><li><ol><li>在<code>mybatis</code>核心配置文件中，设置全局配置属性 <code>cacheEnabled=&quot;true&quot;</code>，默认为 <code>true</code>，不需要设置</li></ol></li><li><ol start="2"><li>在<code>mybatis</code>映射文件中设置标签<code>&lt;cache/&gt;</code></li></ol></li><li><ol start="3"><li>查询的数据所转换的实体类类型必须实现序列化的接口</li></ol></li><li><ol start="4"><li>二级缓存必须在 <code>SqlSession</code> 关闭或提交之后有效</li></ol></li></ul><h3 id="_3-开启二级缓存测试" tabindex="-1">3. 开启二级缓存测试 <a class="header-anchor" href="#_3-开启二级缓存测试" aria-label="Permalink to &quot;3. 开启二级缓存测试&quot;">​</a></h3><h4 id="_1-在mybatis核心配置文件中-设置全局配置属性-cacheenabled-true" tabindex="-1">1. 在<code>mybatis</code>核心配置文件中，设置全局配置属性 <code>cacheEnabled=&quot;true&quot;</code> <a class="header-anchor" href="#_1-在mybatis核心配置文件中-设置全局配置属性-cacheenabled-true" aria-label="Permalink to &quot;1. 在\`mybatis\`核心配置文件中，设置全局配置属性 \`cacheEnabled=&quot;true&quot;\`&quot;">​</a></h4><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> ?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;!</span><span style="color:#F78C6C;">DOCTYPE</span><span style="color:#89DDFF;"> </span><span style="color:#A6ACCD;">configuration</span></span>
<span class="line"><span style="color:#89DDFF;">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">settings</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">setting</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cacheEnabled</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">value</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">settings</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_2-在mybatis映射文件中设置标签-cache" tabindex="-1">2. 在<code>mybatis</code>映射文件中设置标签<code>&lt;cache/&gt;</code> <a class="header-anchor" href="#_2-在mybatis映射文件中设置标签-cache" aria-label="Permalink to &quot;2. 在\`mybatis\`映射文件中设置标签\`&lt;cache/&gt;\`&quot;">​</a></h4><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> ?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;!</span><span style="color:#F78C6C;">DOCTYPE</span><span style="color:#89DDFF;"> </span><span style="color:#A6ACCD;">mapper</span></span>
<span class="line"><span style="color:#89DDFF;">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">mapper</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">namespace</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.zhug.mybatis.mapper.CacheMapper</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">cache</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">cache</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">mapper</span><span style="color:#89DDFF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_3-实体类类型实现序列化的接口" tabindex="-1">3. 实体类类型实现序列化的接口 <a class="header-anchor" href="#_3-实体类类型实现序列化的接口" aria-label="Permalink to &quot;3. 实体类类型实现序列化的接口&quot;">​</a></h4><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Emp</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Serializable</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">//....</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_4-关闭-sqlsession-使二级缓存生效-并测试二级缓存" tabindex="-1">4. 关闭 SqlSession，使二级缓存生效，并测试二级缓存 <a class="header-anchor" href="#_4-关闭-sqlsession-使二级缓存生效-并测试二级缓存" aria-label="Permalink to &quot;4. 关闭 SqlSession，使二级缓存生效，并测试二级缓存&quot;">​</a></h4><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">CacheMapperTest</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testCache</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">InputStream</span><span style="color:#A6ACCD;"> is </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Resources</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getResourceAsStream</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mybatis-config.xml</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">SqlSessionFactoryBuilder</span><span style="color:#A6ACCD;"> sqlSessionFactoryBuilder </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SqlSessionFactoryBuilder</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">SqlSessionFactory</span><span style="color:#A6ACCD;"> sqlSessionFactory </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sqlSessionFactoryBuilder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">build</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">is</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">SqlSession</span><span style="color:#A6ACCD;"> sqlSession1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sqlSessionFactory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">openSession</span><span style="color:#89DDFF;">(true);</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">CacheMapper</span><span style="color:#A6ACCD;"> mapper1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sqlSession1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMapper</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CacheMapper</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">Emp</span><span style="color:#A6ACCD;"> emp1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> mapper1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getEmpById</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">emp1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 关闭 SqlSession，使二级缓存生效</span></span>
<span class="line"><span style="color:#A6ACCD;">      sqlSession1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">SqlSession</span><span style="color:#A6ACCD;"> sqlSession2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sqlSessionFactory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">openSession</span><span style="color:#89DDFF;">(true);</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">CacheMapper</span><span style="color:#A6ACCD;"> mapper2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sqlSession2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMapper</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CacheMapper</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">class</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">Emp</span><span style="color:#A6ACCD;"> emp2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> mapper2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getEmpById</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">emp2</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      关闭 SqlSession，使二级缓存生效</span></span>
<span class="line"><span style="color:#A6ACCD;">      sqlSession2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">IOException</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      e</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printStackTrace</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>案例中<code>sqlSession1</code>和<code>sqlSession2</code>都是由同一个<code>SqlSessionFactory</code>生成的，执行了两次<code>getEmpById(1)</code>，控制台<code>log4j</code>只打印了<strong>一条 sql 执行语句</strong>。</p><p>控制台可以看出，<code>emp1</code>是查询的数据库，<code>emp2</code>没有查询数据库，数据源于<strong>二级缓存</strong></p><h3 id="_3-二级缓存的相关配置" tabindex="-1">3.二级缓存的相关配置 <a class="header-anchor" href="#_3-二级缓存的相关配置" aria-label="Permalink to &quot;3.二级缓存的相关配置&quot;">​</a></h3><p>在 <code>mapper</code> 配置文件中添加的 <code>cache</code>标签可以设置一些属性：</p><h4 id="eviction-属性" tabindex="-1">eviction 属性 <a class="header-anchor" href="#eviction-属性" aria-label="Permalink to &quot;eviction 属性&quot;">​</a></h4><p>缓存回收策略，默认的是 <code>LRU</code>。</p><ul><li><ol><li><code>LRU（Least Recently Used）</code> – 最近最少使用的：移除最长时间不被使用的对象。</li></ol></li><li><ol start="2"><li><code>FIFO（First in First out）</code> – 先进先出：按对象进入缓存的顺序来移除它们。</li></ol></li><li><ol start="3"><li><code>SOFT</code> – 软引用：移除基于垃圾回收器状态和软引用规则的对象。</li></ol></li><li><ol start="4"><li><code>WEAK</code> – 弱引用：更积极地移除基于垃圾收集器状态和弱引用规则的对象。</li></ol></li></ul><h4 id="flushinterval-属性" tabindex="-1">flushInterval 属性 <a class="header-anchor" href="#flushinterval-属性" aria-label="Permalink to &quot;flushInterval 属性&quot;">​</a></h4><p>刷新间隔，单位毫秒。默认情况是不设置，也就是没有刷新间隔，缓存仅仅调用语句时刷新</p><h4 id="size-属性" tabindex="-1">size 属性 <a class="header-anchor" href="#size-属性" aria-label="Permalink to &quot;size 属性&quot;">​</a></h4><p>引用数目，正整数。代表缓存最多可以存储多少个对象，太大容易导致内存溢出</p><h4 id="readonly-属性" tabindex="-1">readOnly 属性 <a class="header-anchor" href="#readonly-属性" aria-label="Permalink to &quot;readOnly 属性&quot;">​</a></h4><p>只读， true/false。</p><ul><li><ol><li><code>true</code>：只读缓存；会给所有调用者返回缓存对象的相同实例。因此这些对象不能被修改。这提供了很重要的性能优势。</li></ol></li><li><ol start="2"><li><code>false</code>：读写缓存；会返回缓存对象的拷贝（通过序列化）。这会慢一些，但是安全，因此默认是 <code>false</code>。</li></ol></li></ul><h3 id="_4-使二级缓存失效情况" tabindex="-1">4.使二级缓存失效情况 <a class="header-anchor" href="#_4-使二级缓存失效情况" aria-label="Permalink to &quot;4.使二级缓存失效情况&quot;">​</a></h3><ul><li><ol><li><strong>两次查询之间</strong>执行了任意的<strong>增删改</strong>，会使一级和二级缓存同时失效</li></ol></li></ul><h3 id="_5-mybatis-缓存查询的顺序" tabindex="-1">5. MyBatis 缓存查询的顺序 <a class="header-anchor" href="#_5-mybatis-缓存查询的顺序" aria-label="Permalink to &quot;5. MyBatis 缓存查询的顺序&quot;">​</a></h3><ul><li><ol><li>先查询二级缓存，因为二级缓存中可能会有其他程序已经查出来的数据，可以拿来直接使用。</li></ol></li><li><ol start="2"><li>如果二级缓存没有命中，再查询一级缓存</li></ol></li><li><ol start="3"><li>如果一级缓存也没有命中，则查询数据库</li></ol></li><li><ol start="4"><li><code>SqlSession</code> 关闭之后，一级缓存中的数据会写入二级缓存</li></ol></li></ul><h2 id="_3-mybatis-整合第三方缓存" tabindex="-1">3. mybatis 整合第三方缓存 <a class="header-anchor" href="#_3-mybatis-整合第三方缓存" aria-label="Permalink to &quot;3. mybatis 整合第三方缓存&quot;">​</a></h2><p><code>mybatis</code> 整合第三方缓存是针对<strong>二级缓存</strong>的。</p><h3 id="_1-添加依赖" tabindex="-1">1. 添加依赖 <a class="header-anchor" href="#_1-添加依赖" aria-label="Permalink to &quot;1. 添加依赖&quot;">​</a></h3><p>在<code>maven</code>的工程配置文件<code>pom.xml</code></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- Mybatis EHCache整合包 --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">org.mybatis.caches</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">mybatis-ehcache</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">1.2.1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- slf4j日志门面的一个具体实现 --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">ch.qos.logback</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">logback-classic</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">1.2.3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>各<code>jar</code>包功能</p><table><thead><tr><th style="text-align:left;">bar 包名称</th><th style="text-align:left;">功能</th></tr></thead><tbody><tr><td style="text-align:left;">mybatis-ehcache</td><td style="text-align:left;">Mybatis 和 EHCache 的整合包</td></tr><tr><td style="text-align:left;">ehcache</td><td style="text-align:left;">EHCache 核心包</td></tr><tr><td style="text-align:left;">slf4j-api</td><td style="text-align:left;">SLF4J 日志门面包</td></tr><tr><td style="text-align:left;">logback-classic</td><td style="text-align:left;">支持 SLF4J 门面接口的一个具体实现</td></tr></tbody></table><h3 id="_2-创建-ehcache-的配置文件-ehcache-xml" tabindex="-1">2. 创建 EHCache 的配置文件 ehcache.xml <a class="header-anchor" href="#_2-创建-ehcache-的配置文件-ehcache-xml" aria-label="Permalink to &quot;2. 创建 EHCache 的配置文件 ehcache.xml&quot;">​</a></h3><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> ?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">ehcache</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">noNamespaceSchemaLocation</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">../config/ehcache.xsd</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">&lt;!-- 磁盘保存路径 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">diskStore</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">path</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">D:\\zhug\\ehcache</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">defaultCache</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#C792EA;">maxElementsInMemory</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1000</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#C792EA;">maxElementsOnDisk</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">10000000</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#C792EA;">eternal</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">false</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#C792EA;">overflowToDisk</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#C792EA;">timeToIdleSeconds</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">120</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#C792EA;">timeToLiveSeconds</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">120</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#C792EA;">diskExpiryThreadIntervalSeconds</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">120</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#C792EA;">memoryStoreEvictionPolicy</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">LRU</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">defaultCache</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">ehcache</span><span style="color:#89DDFF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_3-设置二级缓存的类型" tabindex="-1">3. 设置二级缓存的类型 <a class="header-anchor" href="#_3-设置二级缓存的类型" aria-label="Permalink to &quot;3. 设置二级缓存的类型&quot;">​</a></h3><p>在对应的<code>mapper</code>接口映射文件添加</p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">cache</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">org.mybatis.caches.ehcache.EhcacheCache</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_4-加入-logback-日志" tabindex="-1">4. 加入 logback 日志 <a class="header-anchor" href="#_4-加入-logback-日志" aria-label="Permalink to &quot;4. 加入 logback 日志&quot;">​</a></h3><p>存在 <code>SLF4J</code> 时，作为简易日志的 <code>log4j</code> 将失效，此时我们需要借助 <code>SLF4J</code> 的具体实现 <code>logback</code> 来打印日 志。 创建 <code>logback</code> 的配置文件 <code>logback.xml</code></p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">debug</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">&lt;!-- 指定日志输出的位置 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">appender</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">STDOUT</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ch.qos.logback.core.ConsoleAppender</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">encoder</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;font-style:italic;">&lt;!-- 日志输出的格式 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;font-style:italic;">&lt;!-- 按照顺序分别是： 时间、日志级别、线程名称、打印日志的类、日志主体内容、换行</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">            --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">pattern</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">[%d{HH:mm:ss.SSS}] [%-5level] [%thread] [%logger]</span></span>
<span class="line"><span style="color:#A6ACCD;">                [%msg]%n</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">pattern</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">encoder</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">appender</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">&lt;!-- 设置全局日志级别。日志级别按顺序分别是： DEBUG、INFO、WARN、ERROR --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">&lt;!-- 指定任何一个日志级别都只打印当前级别和后面级别的日志。 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">root</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">level</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">DEBUG</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">&lt;!-- 指定打印日志的appender，这里通过“STDOUT”引用了前面配置的appender --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">appender-ref</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">ref</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">STDOUT</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">root</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">&lt;!-- 根据特殊需求指定局部日志级别 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">logger</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.zhug.mybatis.mapper</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">level</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">DEBUG</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">configuration</span><span style="color:#89DDFF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>至此<code>MyBatis</code>整合第三方缓存就配置完了，测试我们可以使用<code>2.MyBatis二级缓存</code>的案例进行测试</p><h3 id="_5-ehcache-配置文件说明" tabindex="-1">5.EHCache 配置文件说明 <a class="header-anchor" href="#_5-ehcache-配置文件说明" aria-label="Permalink to &quot;5.EHCache 配置文件说明&quot;">​</a></h3><h4 id="maxelementsinmemory" tabindex="-1">maxElementsInMemory <a class="header-anchor" href="#maxelementsinmemory" aria-label="Permalink to &quot;maxElementsInMemory&quot;">​</a></h4><ul><li><ol><li>是否是必须 ：是</li></ol></li><li><ol start="2"><li>作用</li></ol><p>在内存中缓存的 <code>element</code> 的最大数目</p></li></ul><h4 id="maxelementsondisk" tabindex="-1">maxElementsOnDisk <a class="header-anchor" href="#maxelementsondisk" aria-label="Permalink to &quot;maxElementsOnDisk&quot;">​</a></h4><ul><li><ol><li>是否是必须 ：是</li></ol></li><li><ol start="2"><li>作用</li></ol></li></ul><p>在磁盘上缓存的 <code>element</code> 的最大数目，若是<code>0</code> 表示无穷大</p><h4 id="eternal" tabindex="-1">eternal <a class="header-anchor" href="#eternal" aria-label="Permalink to &quot;eternal&quot;">​</a></h4><ul><li><ol><li>是否是必须 ： 是</li></ol></li><li><ol start="2"><li>作用</li></ol></li></ul><p>设定缓存的 <code>elements</code> 是否永远不过期。 如果为 <code>true</code>，则缓存的数据始终有效， 如果为 <code>false</code> 那么还 要根据 <code>timeToIdleSeconds</code>、<code>timeToLiveSeconds</code> 判断</p><h4 id="overflowtodisk" tabindex="-1">overflowToDisk <a class="header-anchor" href="#overflowtodisk" aria-label="Permalink to &quot;overflowToDisk&quot;">​</a></h4><ul><li><ol><li>是否是必须 ： 是</li></ol></li><li><ol start="2"><li>作用</li></ol></li></ul><p>设定当内存缓存溢出的时候是否将过期的 <code>element</code> 缓存到磁盘上</p><h4 id="timetoidleseconds" tabindex="-1">timeToIdleSeconds <a class="header-anchor" href="#timetoidleseconds" aria-label="Permalink to &quot;timeToIdleSeconds&quot;">​</a></h4><ul><li><ol><li>是否是必须 ： 否</li></ol></li><li><ol start="2"><li>作用</li></ol></li></ul><p>当缓存在 <code>EhCache</code> 中的数据前后两次访问的时间超 过 <code>timeToIdleSeconds</code> 的属性取值时， 这些数据便 会删除，默认值是 <code>0</code>,也就是可闲置时间无穷大</p><h4 id="timetoliveseconds" tabindex="-1">timeToLiveSeconds <a class="header-anchor" href="#timetoliveseconds" aria-label="Permalink to &quot;timeToLiveSeconds&quot;">​</a></h4><ul><li><ol><li>是否是必须 ：否</li></ol></li><li><ol start="2"><li>作用</li></ol></li></ul><p>缓存 <code>element</code> 的有效生命期，默认是<code>0</code>,也就是 <code>element</code> 存活时间无穷大</p><h4 id="diskspoolbuffersizemb" tabindex="-1">diskSpoolBufferSizeMB <a class="header-anchor" href="#diskspoolbuffersizemb" aria-label="Permalink to &quot;diskSpoolBufferSizeMB&quot;">​</a></h4><ul><li><ol><li>是否是必须 ： 否</li></ol></li><li><ol start="2"><li>作用</li></ol></li></ul><p><code>DiskStore</code>(磁盘缓存)的缓存区大小。默认是 <code>30MB</code>。每个 <code>Cache</code> 都应该有自己的一个缓冲区</p><h4 id="diskpersistent" tabindex="-1">diskPersistent <a class="header-anchor" href="#diskpersistent" aria-label="Permalink to &quot;diskPersistent&quot;">​</a></h4><ul><li><ol><li>是否是必须 ： 否</li></ol></li><li><ol start="2"><li>作用</li></ol></li></ul><p>在 <code>VM</code> 重启的时候是否启用磁盘保存<code>EhCache</code> 中的数 据，默认是 <code>false</code>。</p><h4 id="diskexpirythreadintervalseconds" tabindex="-1">diskExpiryThreadIntervalSeconds <a class="header-anchor" href="#diskexpirythreadintervalseconds" aria-label="Permalink to &quot;diskExpiryThreadIntervalSeconds&quot;">​</a></h4><ul><li><ol><li>是否是必须 ： 否</li></ol></li><li><ol start="2"><li>作用</li></ol></li></ul><p>磁盘缓存的清理线程运行间隔，默认是 <code>120</code> 秒。每 个<code>120s</code>， 相应的线程会进行一次 <code>EhCache</code> 中数据的 清理工作</p><h4 id="memorystoreevictionpolicy" tabindex="-1">memoryStoreEvictionPolicy <a class="header-anchor" href="#memorystoreevictionpolicy" aria-label="Permalink to &quot;memoryStoreEvictionPolicy&quot;">​</a></h4><ul><li><ol><li>是否是必须 ： 否</li></ol></li><li><ol start="2"><li>作用</li></ol></li></ul><p>当内存缓存达到最大，有新的<code>element</code> 加入的时 候， 移除缓存中 <code>element</code> 的策略。 默认是<code>LRU</code>（最 近最少使用），可选的有 <code>LFU</code>（最不常使用）和 <code>FIFO</code> （先进先出）</p>`,96),e=[o];function t(c,r,D,y,i,F){return a(),n("div",null,e)}const A=s(p,[["render",t]]);export{d as __pageData,A as default};
